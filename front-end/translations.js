const translations = {
  en: {
    'app.title': 'LexiPark',
    'vocab.title': 'Your Vocabulary',
    'vocab.word': 'Word',
    'vocab.translation': 'Translation',
    'vocab.frequency': 'Frequency',
    'vocab.retention': 'Retention',
    'vocab.chart_title': 'Daily Growth',
    'vocab.chart_subtitle': 'Cumulative known words',
    'vocab.chart_total': 'total words',
    'vocab.chart_empty': 'No history yet',
    'nav.welcome': 'Welcome, {username}!',
    'nav.vocab': 'Vocab',
    'nav.learn': 'Learn',
    'nav.document': 'Document Translate',
    'nav.logout': 'Logout',
    'nav.login': 'Login',
    'nav.register': 'Register',
    'auth.login': 'Login',
    'auth.register': 'Register',
    'auth.username': 'Username',
    'auth.email': 'Email',
    'auth.password': 'Password',
    'auth.native_language': 'Native Language',
    'auth.select': 'Select...',
    'auth.title': 'Korean Live Transcription',
    'button.speak': 'Speak',
    'button.listen': 'Listen',
    'button.voice_translation': 'Voice Translation',
    'status.ready': 'Ready',
    'status.recording': 'Recording {language}...',
    'status.not_supported': 'Speech recognition not supported',
    'learn.title': 'Learning Mode',
    'learn.no_items': 'No vocabulary items',
    'learn.swipe_remember': 'Remember →',
    'learn.swipe_dont_remember': '← Don\'t Remember',
    'learn.loading': 'Loading...',
    'learn.translation': 'Translation',
    'learn.login_required': 'Please log in to use learning mode',
    'learn.done': 'That\'s it for today!',
    'doc.title': 'Document Translate',
    'doc.input_placeholder': 'Paste text to translate',
    'doc.translate_btn': 'Translate',
    'doc.clear_btn': 'Clear',
    'doc.status_idle': 'Paste text and run translation',
    'doc.status_processing': 'Processing document...',
    'doc.status_success': 'Translation and cards ready',
    'doc.status_error': 'Translation failed. Try again.',
    'doc.translation_title': 'Translation',
    'doc.cards_title': 'Word Cards',
    'doc.no_words': 'No words detected yet',
    'doc.auth_required': 'Login required for card creation',
    'doc.source_ko': 'Korean input',
    'doc.source_native': 'My language input'
  },
  ru: {
    'app.title': 'Лексипарк',
    'vocab.title': 'Ваш словарь',
    'vocab.word': 'Слово',
    'vocab.translation': 'Перевод',
    'vocab.frequency': 'Частота',
    'vocab.retention': 'Удержание',
    'vocab.chart_title': 'Ежедневный рост',
    'vocab.chart_subtitle': 'Накопленное количество слов',
    'vocab.chart_total': 'всего слов',
    'vocab.chart_empty': 'Пока нет истории',
    'nav.welcome': 'Добро пожаловать, {username}!',
    'nav.vocab': 'Словарь',
    'nav.learn': 'Учить',
    'nav.document': 'Перевод документов',
    'nav.logout': 'Выйти',
    'nav.login': 'Войти',
    'nav.register': 'Регистрация',
    'auth.login': 'Войти',
    'auth.register': 'Регистрация',
    'auth.username': 'Имя пользователя',
    'auth.email': 'Email',
    'auth.password': 'Пароль',
    'auth.native_language': 'Родной язык',
    'auth.select': 'Выбрать...',
    'auth.title': 'Корейская транскрипция в реальном времени',
    'button.speak': 'Говорить',
    'button.listen': 'Слушать',
    'button.voice_translation': 'Голосовой перевод',
    'status.ready': 'Готов',
    'status.recording': 'Запись {language}...',
    'status.not_supported': 'Распознавание речи не поддерживается',
    'learn.title': 'Режим обучения',
    'learn.no_items': 'Нет слов в словаре',
    'learn.swipe_remember': 'Помню →',
    'learn.swipe_dont_remember': '← Не помню',
    'learn.loading': 'Загрузка...',
    'learn.translation': 'Перевод',
    'learn.login_required': 'Пожалуйста, войдите, чтобы использовать режим обучения',
    'learn.done': 'На сегодня всё!',
    'doc.title': 'Перевод документов',
    'doc.input_placeholder': 'Вставьте текст для перевода',
    'doc.translate_btn': 'Перевести',
    'doc.clear_btn': 'Очистить',
    'doc.status_idle': 'Вставьте текст и запустите перевод',
    'doc.status_processing': 'Документ обрабатывается...',
    'doc.status_success': 'Перевод и карточки готовы',
    'doc.status_error': 'Не удалось перевести. Попробуйте снова.',
    'doc.translation_title': 'Перевод',
    'doc.cards_title': 'Карточки слов',
    'doc.no_words': 'Слова не найдены',
    'doc.auth_required': 'Для создания карточек нужно войти',
    'doc.source_ko': 'Корейский текст',
    'doc.source_native': 'Мой язык'
  },
  zh: {
    'app.title': '韩语实时转录',
    'vocab.title': '您的词汇',
    'vocab.word': '单词',
    'vocab.translation': '翻译',
    'vocab.frequency': '频率',
    'vocab.retention': '保持率',
    'vocab.chart_title': '每日增长',
    'vocab.chart_subtitle': '累计已掌握单词',
    'vocab.chart_total': '总词数',
    'vocab.chart_empty': '暂无历史数据',
    'nav.welcome': '欢迎，{username}！',
    'nav.vocab': '词汇',
    'nav.learn': '学习',
    'nav.document': '文档翻译',
    'nav.logout': '登出',
    'nav.login': '登录',
    'nav.register': '注册',
    'auth.login': '登录',
    'auth.register': '注册',
    'auth.username': '用户名',
    'auth.email': '邮箱',
    'auth.password': '密码',
    'auth.native_language': '母语',
    'auth.select': '选择...',
    'auth.title': '韩语实时转录',
    'button.speak': '说话',
    'button.listen': '听',
    'button.voice_translation': '语音翻译',
    'status.ready': '就绪',
    'status.recording': '正在录制 {language}...',
    'status.not_supported': '不支持语音识别',
    'learn.title': '学习模式',
    'learn.no_items': '没有词汇',
    'learn.swipe_remember': '记住 →',
    'learn.swipe_dont_remember': '← 不记得',
    'learn.loading': '加载中...',
    'learn.translation': '翻译',
    'learn.login_required': '请登录以使用学习模式',
    'learn.done': '今天就到这里！',
    'doc.title': '文档翻译',
    'doc.input_placeholder': '粘贴需要翻译的文本',
    'doc.translate_btn': '翻译',
    'doc.clear_btn': '清除',
    'doc.status_idle': '粘贴文本后开始翻译',
    'doc.status_processing': '正在处理文档...',
    'doc.status_success': '译文与卡片已完成',
    'doc.status_error': '翻译失败，请重试。',
    'doc.translation_title': '译文',
    'doc.cards_title': '单词卡片',
    'doc.no_words': '未检测到单词',
    'doc.auth_required': '创建卡片需登录',
    'doc.source_ko': '韩文输入',
    'doc.source_native': '母语输入'
  },
  vi: {
    'app.title': 'Phiên âm tiếng Hàn trực tiếp',
    'vocab.title': 'Từ vựng của bạn',
    'vocab.word': 'Từ',
    'vocab.translation': 'Bản dịch',
    'vocab.frequency': 'Tần suất',
    'vocab.retention': 'Giữ nhớ',
    'vocab.chart_title': 'Tăng trưởng hằng ngày',
    'vocab.chart_subtitle': 'Từ vựng tích lũy',
    'vocab.chart_total': 'tổng số từ',
    'vocab.chart_empty': 'Chưa có dữ liệu',
    'nav.welcome': 'Chào mừng, {username}!',
    'nav.vocab': 'Từ vựng',
    'nav.learn': 'Học',
    'nav.document': 'Dịch tài liệu',
    'nav.logout': 'Đăng xuất',
    'nav.login': 'Đăng nhập',
    'nav.register': 'Đăng ký',
    'auth.login': 'Đăng nhập',
    'auth.register': 'Đăng ký',
    'auth.username': 'Tên người dùng',
    'auth.email': 'Email',
    'auth.password': 'Mật khẩu',
    'auth.native_language': 'Ngôn ngữ mẹ đẻ',
    'auth.select': 'Chọn...',
    'auth.title': 'Phiên âm tiếng Hàn trực tiếp',
    'button.speak': 'Nói',
    'button.listen': 'Nghe',
    'button.voice_translation': 'Dịch giọng nói',
    'status.ready': 'Sẵn sàng',
    'status.recording': 'Đang ghi {language}...',
    'status.not_supported': 'Nhận dạng giọng nói không được hỗ trợ',
    'learn.title': 'Chế độ học tập',
    'learn.no_items': 'Không có từ vựng',
    'learn.swipe_remember': 'Nhớ →',
    'learn.swipe_dont_remember': '← Không nhớ',
    'learn.loading': 'Đang tải...',
    'learn.translation': 'Bản dịch',
    'learn.login_required': 'Vui lòng đăng nhập để sử dụng chế độ học tập',
    'learn.done': 'Hôm nay tạm thế!',
    'doc.title': 'Dịch tài liệu',
    'doc.input_placeholder': 'Dán văn bản để dịch',
    'doc.translate_btn': 'Dịch',
    'doc.clear_btn': 'Xóa',
    'doc.status_idle': 'Dán văn bản rồi bắt đầu dịch',
    'doc.status_processing': 'Đang xử lý tài liệu...',
    'doc.status_success': 'Bản dịch và thẻ đã sẵn sàng',
    'doc.status_error': 'Dịch thất bại. Thử lại.',
    'doc.translation_title': 'Bản dịch',
    'doc.cards_title': 'Thẻ từ vựng',
    'doc.no_words': 'Không tìm thấy từ nào',
    'doc.auth_required': 'Cần đăng nhập để tạo thẻ',
    'doc.source_ko': 'Nhập tiếng Hàn',
    'doc.source_native': 'Nhập ngôn ngữ của tôi'
  }
};

import { getCurrentUser } from './auth.js';

export function t(key, params = {}) {
  const user = getCurrentUser();
  const lang = user?.native_language || localStorage.getItem('selectedLanguage') || 'en';
  const langMap = translations[lang] || translations.en;
  let text = langMap[key] || translations.en[key] || key;
  
  Object.keys(params).forEach(param => {
    text = text.replace(`{${param}}`, params[param]);
  });
  
  return text;
}

export function translatePage() {
  document.querySelectorAll('[data-i18n]').forEach(el => {
    const key = el.getAttribute('data-i18n');
    const params = {};
    el.querySelectorAll('[data-i18n-param]').forEach(paramEl => {
      const paramName = paramEl.getAttribute('data-i18n-param');
      const paramValue = paramEl.textContent || paramEl.value;
      params[paramName] = paramValue;
    });
    el.textContent = t(key, params);
  });
  
  document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
    const key = el.getAttribute('data-i18n-placeholder');
    el.placeholder = t(key);
  });
  
  document.querySelectorAll('[data-i18n-title]').forEach(el => {
    const key = el.getAttribute('data-i18n-title');
    el.title = t(key);
  });
}

